# fair-sciml
FAIR Scientific Machine Learning

This repository is dedicated to advancing the principles of Findable, Accessible, Interoperable, and Reusable (FAIR) data in the field of scientific machine learning, particularly focusing on the solutions of partial differential equations (PDEs). It provides well-documented datasets and code that facilitate the reproducible research and collaborative development of PDE-solving algorithms.

## **Table of Contents**

- [Project Structure](#project-structure)
- [Features](#features)
- [Installation](#installation)
- [Usage](#usage)
- [Simulators](#simulators)
  - [Base Simulator](#base-simulator)
  - [Poisson Simulator](#poisson-simulator)
  - [Biharmonic Simulator](#biharmonic-simulator)
- [DeepONet Training](#deeponet-training)
- [Documentation](#documentation)
- [Contributing](#contributing)
- [License](#license)

---

## **Project Structure**

```bash
fair-sciml/
│
├── src/                     # Source code for the project
│   ├── simulators/          # Different PDE simulators
│   │   ├── base_simulator.py
│   │   ├── poisson_simulator.py
│   │   └── biharmonic_simulator.py
│   └── ml/                  # Machine learning models (e.g., DeepONet)
│       └── deeponet_trainer.py
├── docs/                    # Documentation files (for ReadTheDocs)
│   ├── conf.py
│   ├── index.rst
│   ├── simulators.rst
│   └── deeponet.rst
├── requirements.txt         # List of dependencies
├── README.md                # Project overview and instructions (this file)
└── LICENSE                  # Project license
```

---

## **Features**

- Modular PDE Simulators:
  - Abstract BaseSimulator for reusable logic.
  - Poisson and Biharmonic equation simulators.
  - Simulation results saved in HDF5 format with metadata.

- DeepONet Model Training:

  - Train Deep Operator Networks (DeepONet) using PDE simulations.
  - Preprocessing pipelines with branch and trunk networks.

- Support for Local and Cloud Data:

  - Load simulation data from local HDF5 files or Hugging Face datasets.

---

## ** Installation **
1. Clone the repository:
```bash
git clone https://github.com/pescap/fair-sciml.git
cd fair-sciml
```

2. Create a virtual environment (recommended)
```bash
python3 -m venv env
source env/bin/activate  # On Linux/macOS
```

3. Install dependencies:
```bash
pip install -r requirements.txt
```

---

## **Usage**

1. Run a Poisson simulation: 
```bash
python3 src/simulators/poisson_simulator.py \
    --source_strength_min 10.0 \
    --source_strength_max 20.0 \
    --neumann_coefficient_min 5.0 \
    --neumann_coefficient_max 10.0 \
    --num_simulations 5 \
    --mesh_size 32 \
    --output_path "poisson_results.h5"
```
2. Train the DeepONet model:
```bash
python3 src/ml/deeponet_trainer.py
```

---

## **Simulators**

### **Base Simulator**

The `BaseSimulator` class provides the foundation for all PDE simulators, implementing shared logic such as **metadata collection**, **HDF5 file handling**, and **simulation session management**. It defines two key methods:

- **`setup_problem()`**: Abstract method for setting up the PDE.
- **`run_simulation()`**: Runs a single simulation and stores the results.

### **Poisson Simulator**

The `PoissonSimulator` solves the **Poisson equation** with Dirichlet and Neumann boundary conditions. Example parameters:

- **Source Strength**: Controls the source term's intensity.
- **Neumann Coefficient**: Coefficient for the Neumann boundary condition.

### **Biharmonic Simulator**

The `BiharmonicSimulator` solves the **Biharmonic equation** using a discontinuous Galerkin method. It supports parameterized penalty terms.

---

## **DeepONet Training**

The `DeepONetTrainer` trains a **Deep Operator Network (DeepONet)** using data generated by the PDE simulators. The trainer supports:

- **Branch network**: Encodes parameters such as source strength and Neumann coefficients.
- **Trunk network**: Encodes coordinates for PDE solutions.

Example:

```python
from ml.deeponet_trainer import DeepONetTrainer
from data_loaders.huggingface_loader import HuggingFaceLoader

data_loader = HuggingFaceLoader(repo_id="aledhf/pde_sims", file_name="simulations.h5")
trainer = DeepONetTrainer(branch_layers=[2, 128, 128], trunk_layers=[2, 128, 128], data_loader=data_loader)
trainer.train(epochs=10000, batch_size=32, learning_rate=0.0001)
```

---

## **Documentation**

Complete documentation for this projecty is available on [ReadTheDocs](https://fair-sciml.readthedocs.io/)

---

## Cite This Work

If you use this data or code for your research, please cite this GitHub repository:

```bibtex
@misc{fair_sciml2024,
  title   = {FAIR Scientific Machine Learning},
  author  = {Paul Escapil, Eduardo Álvarez and Adolfo Parra},
  year    = {2024},
  url     = {https://github.com/pescap/fair-sciml}
}
```
---

## **Acknowledgments**

- Built with [FEniCS](https://fenicsproject.org/).
- Deep learning with [DeepXDE](https://github.com/lululxvi/deepxde).
- Documentation powered by [ReadTheDocs](https://fair-sciml.readthedocs.io/).
